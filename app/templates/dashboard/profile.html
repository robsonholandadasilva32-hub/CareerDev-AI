{% extends "dashboard_layout.html" %}

{% block dashboard_content %}
<div class="card profile-settings">
    <h2>üë§ My Account</h2>
    <p>Update your personal information and addresses.</p>

    <form action="/dashboard/profile" method="POST" style="margin-top: 30px; max-width: 800px;">
        <!-- INFO BASICA -->
        <h3>Personal Information</h3>
        <div style="display: grid; grid-template-columns: 1fr; gap: 20px; margin-bottom: 20px;">
            <div>
                <label>Full Name</label>
                <input type="text" name="name" value="{{ user.name }}" required class="form-control" style="width: 100%; padding: 10px; background: #1f2937; border: 1px solid #374151; color: white; border-radius: 6px;">
            </div>
            <div>
                <label>Email (Not editable)</label>
                <input type="email" value="{{ user.email }}" disabled class="form-control" style="width: 100%; padding: 10px; background: #111827; border: 1px solid #374151; color: #9ca3af; border-radius: 6px;">
            </div>
        </div>

        <hr style="border-color: #374151; margin: 30px 0;">

        <!-- ENDERECO RESIDENCIAL -->
        <h3>üè° Residential Address</h3>
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px;">
            <div style="grid-column: span 2;">
                <label>Street Address</label>
                <input type="text" name="address_street" value="{{ user.address_street or '' }}" class="form-control" style="width: 100%; padding: 10px; background: #1f2937; border: 1px solid #374151; color: white; border-radius: 6px;">
            </div>
            <div>
                <label>Number</label>
                <input type="text" name="address_number" value="{{ user.address_number or '' }}" class="form-control" style="width: 100%; padding: 10px; background: #1f2937; border: 1px solid #374151; color: white; border-radius: 6px;">
            </div>
            <div>
                <label>Unit / Suite</label>
                <input type="text" name="address_complement" value="{{ user.address_complement or '' }}" class="form-control" style="width: 100%; padding: 10px; background: #1f2937; border: 1px solid #374151; color: white; border-radius: 6px;">
            </div>
            <div>
                <label>City</label>
                <input type="text" name="address_city" value="{{ user.address_city or '' }}" class="form-control" style="width: 100%; padding: 10px; background: #1f2937; border: 1px solid #374151; color: white; border-radius: 6px;">
            </div>
             <div>
                <label>State / Province</label>
                <input type="text" name="address_state" value="{{ user.address_state or '' }}" class="form-control" style="width: 100%; padding: 10px; background: #1f2937; border: 1px solid #374151; color: white; border-radius: 6px;">
            </div>
            <div>
                <label>Zip / Postal Code</label>
                <input type="text" name="address_zip_code" value="{{ user.address_zip_code or '' }}" class="form-control" style="width: 100%; padding: 10px; background: #1f2937; border: 1px solid #374151; color: white; border-radius: 6px;">
            </div>
            <div>
                <label>Country</label>
                <input type="text" name="address_country" value="{{ user.address_country or '' }}" class="form-control" style="width: 100%; padding: 10px; background: #1f2937; border: 1px solid #374151; color: white; border-radius: 6px;">
            </div>
        </div>

        <hr style="border-color: #374151; margin: 30px 0;">

        <!-- ENDERECO COBRANCA -->
        <h3>üí≥ Billing Address</h3>
        <div style="margin-bottom: 20px;">
            <label style="display: flex; align-items: center; gap: 10px; cursor: pointer;">
                <input type="checkbox" id="billing_same" name="billing_same_as_residential" onchange="toggleBilling()" {% if not user.billing_address_street or user.billing_address_street == user.address_street %}checked{% endif %}>
                <span style="font-size: 0.9rem;">Same as residential</span>
            </label>
        </div>

        <div id="billing_fields" style="display: {% if not user.billing_address_street or user.billing_address_street == user.address_street %}none{% else %}grid{% endif %}; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px;">
             <div style="grid-column: span 2;">
                <label>Street Address</label>
                <input type="text" name="billing_address_street" value="{{ user.billing_address_street or '' }}" class="form-control" style="width: 100%; padding: 10px; background: #1f2937; border: 1px solid #374151; color: white; border-radius: 6px;">
            </div>
            <div>
                <label>Number</label>
                <input type="text" name="billing_address_number" value="{{ user.billing_address_number or '' }}" class="form-control" style="width: 100%; padding: 10px; background: #1f2937; border: 1px solid #374151; color: white; border-radius: 6px;">
            </div>
            <div>
                <label>Unit / Suite</label>
                <input type="text" name="billing_address_complement" value="{{ user.billing_address_complement or '' }}" class="form-control" style="width: 100%; padding: 10px; background: #1f2937; border: 1px solid #374151; color: white; border-radius: 6px;">
            </div>
            <div>
                <label>City</label>
                <input type="text" name="billing_address_city" value="{{ user.billing_address_city or '' }}" class="form-control" style="width: 100%; padding: 10px; background: #1f2937; border: 1px solid #374151; color: white; border-radius: 6px;">
            </div>
             <div>
                <label>State / Province</label>
                <input type="text" name="billing_address_state" value="{{ user.billing_address_state or '' }}" class="form-control" style="width: 100%; padding: 10px; background: #1f2937; border: 1px solid #374151; color: white; border-radius: 6px;">
            </div>
            <div>
                <label>Zip / Postal Code</label>
                <input type="text" name="billing_address_zip_code" value="{{ user.billing_address_zip_code or '' }}" class="form-control" style="width: 100%; padding: 10px; background: #1f2937; border: 1px solid #374151; color: white; border-radius: 6px;">
            </div>
            <div>
                <label>Country</label>
                <input type="text" name="billing_address_country" value="{{ user.billing_address_country or '' }}" class="form-control" style="width: 100%; padding: 10px; background: #1f2937; border: 1px solid #374151; color: white; border-radius: 6px;">
            </div>
        </div>

        {% if success %}
        <div style="background: rgba(0, 255, 136, 0.2); border: 1px solid #00ff88; color: #00ff88; padding: 10px; border-radius: 6px; margin-bottom: 20px;">
            Profile updated successfully!
        </div>
        {% endif %}

        {% if error %}
        <div style="background: rgba(255, 0, 85, 0.2); border: 1px solid #ff0055; color: #ff0055; padding: 10px; border-radius: 6px; margin-bottom: 20px;">
            {{ error }}
        </div>
        {% endif %}

        <button type="submit" class="btn">Save Changes</button>
    </form>
</div>

<script>
    function toggleBilling() {
        const checkbox = document.getElementById('billing_same');
        const fields = document.getElementById('billing_fields');
        fields.style.display = checkbox.checked ? 'none' : 'grid';
    }
</script>
{% endblock %}
