{% extends "base.html" %}

{% block content %}
<div class="dashboard-grid">
    <!-- SECURITY HEADER -->
    <div class="card security-status">
        <div style="display: flex; justify-content: space-between; align-items: center;">
            <div>
                <h3>üîí {{ t.dash_security_active }}</h3>
                <p style="color: #00ff88; font-size: 0.9em;">{{ t.dash_security_detail }}</p>
            </div>
            <div>
                <a href="/security" class="btn-outline">{{ t.dash_manage_security }}</a>
            </div>
        </div>
    </div>

    <!-- QUICK ACTIONS -->
    <div class="card actions" style="margin-top: 20px;">
        <h3>‚ö° A√ß√µes R√°pidas</h3>
        <div style="display: flex; gap: 15px; flex-wrap: wrap; margin-top: 15px;">
            <a href="/security" class="btn-action">
                <span>üîÑ</span> Atualizar senha
            </a>
            <a href="/security" class="btn-action">
                <span>üîê</span> Gerenciar seguran√ßa da conta
            </a>
            <a href="#" class="btn-action">
                <span>üìà</span> Ver progresso detalhado
            </a>
            <a href="/logout" class="btn-action danger">
                <span>üö™</span> Sair com seguran√ßa
            </a>
        </div>
    </div>

    <style>
        .btn-action {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 10px 16px;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid var(--accent-color);
            border-radius: 8px;
            color: var(--text-color);
            transition: all 0.2s;
            font-size: 0.9rem;
        }
        .btn-action:hover {
            background: rgba(0, 243, 255, 0.1);
            border-color: var(--primary-color);
            color: var(--primary-color);
            text-decoration: none;
            transform: translateY(-2px);
        }
        .btn-action.danger:hover {
            background: rgba(255, 0, 85, 0.1);
            border-color: var(--error-color);
            color: var(--error-color);
        }
    </style>

    <!-- USER IDENTITY -->
    <div class="card user-identity" style="margin-top: 20px;">
        <h2>{{ t.dash_welcome }}, {{ email }}</h2>
        <div class="stats-row" style="display: flex; gap: 20px; margin-top: 15px;">
            <div class="stat-item">
                <span class="label">{{ t.dash_level }}</span>
                <span class="value">{{ profile.level }}</span>
            </div>
            <div class="stat-item">
                <span class="label">{{ t.dash_area }}</span>
                <span class="value">{{ profile.focus }}</span>
            </div>
            <div class="stat-item">
                <span class="label">{{ t.dash_skills }}</span>
                <span class="value">
                    {% for skill, score in profile.skills.items() %}
                        {% if score > 50 %}{{ skill }} {% endif %}
                    {% endfor %}
                </span>
            </div>
        </div>

        <div class="progress-container" style="margin-top: 15px; background: #374151; height: 10px; border-radius: 5px;">
            <div class="progress-bar" style="width: 78%; background: var(--primary-color); height: 100%; border-radius: 5px; box-shadow: 0 0 10px var(--primary-color);"></div>
        </div>
    </div>

    <!-- CAREER TRENDS (DYNAMIC) -->
    <div class="card trends" style="margin-top: 20px;">
        <h3>{{ t.dash_trends_title }}</h3>
        <p style="color: #9ca3af; font-size: 0.9em; margin-bottom: 15px;">Monitoramento de mercado em tempo real para seu perfil.</p>

        <div class="trends-grid" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px;">
            {% for tech, demand in profile.trends.items() %}
            <div class="trend-card" style="background: rgba(255, 255, 255, 0.03); padding: 15px; border-radius: 8px; border: 1px solid var(--border-soft);">
                <h4 style="color: {% if demand == 'Very High' %}#00ff88{% elif demand == 'High' %}#00f3ff{% else %}#fbbf24{% endif %}; margin: 0 0 10px 0;">
                    {{ tech }}
                </h4>
                <p style="margin: 0; font-size: 0.9rem;">Demanda: <strong>{{ demand }}</strong></p>
            </div>
            {% endfor %}
        </div>
    </div>

    <!-- AI GENERATED PLAN -->
    <div class="card projects" style="margin-top: 20px;">
        <div style="display: flex; justify-content: space-between; align-items: center;">
            <h3>{{ t.dash_plan_title }} (AI Driven)</h3>
            <span class="badge">Atualizado Semanalmente</span>
        </div>

        <div class="plan-list" style="margin-top: 15px; display: grid; gap: 15px;">
            {% for item in plan %}
            <div class="plan-item" style="background: rgba(0, 0, 0, 0.3); padding: 15px; border-radius: 8px; border-left: 4px solid var(--primary-color);">
                <div style="display: flex; justify-content: space-between;">
                    <h4 style="margin: 0;">{{ item.title }}</h4>
                    <span style="font-size: 0.8rem; padding: 2px 8px; border-radius: 10px; background: rgba(255, 255, 255, 0.1);">
                        {{ item.technology }}
                    </span>
                </div>
                <p style="color: #d1d5db; font-size: 0.9rem; margin: 8px 0;">{{ item.description }}</p>

                {% if item.resources %}
                <div style="margin-top: 10px; font-size: 0.85rem;">
                    <strong>üìö Recursos:</strong>
                    {% for res in item.resources %}
                        <a href="{{ res }}" target="_blank" style="color: var(--accent-blue);">Link {{ loop.index }}</a>
                    {% endfor %}
                </div>
                {% endif %}

                <div style="margin-top: 10px; text-align: right;">
                    <small style="color: #6b7280;">Prazo: {{ item.due_date.strftime('%d/%m') if item.due_date else 'Sem prazo' }}</small>
                </div>
            </div>
            {% else %}
            <p>Gerando seu plano personalizado com IA...</p>
            {% endfor %}
        </div>
    </div>

    <!-- NETWORKING & COMMUNITY -->
    <div class="card networking" style="margin-top: 20px;">
        <h3>ü§ù Networking & Comunidade</h3>
        <p>Conex√µes sugeridas baseadas no seu foco em <strong>{{ profile.focus }}</strong>:</p>
        <div style="display: flex; gap: 15px; flex-wrap: wrap; margin-top: 10px;">
             <a href="https://discord.gg/rust-lang" target="_blank" class="btn-action">Rust Discord</a>
             <a href="https://gophers.slack.com/" target="_blank" class="btn-action">Gophers Slack</a>
             <a href="#" class="btn-action">Simular Entrevista T√©cnica</a>
        </div>
    </div>
</div>
{% endblock %}
