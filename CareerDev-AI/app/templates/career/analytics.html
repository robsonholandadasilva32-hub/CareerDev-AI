{% extends "base.html" %}

{% block content %}
<div class="analytics-container">
    <div style="margin-bottom: 30px; display: flex; justify-content: space-between; align-items: center;">
        <div>
            <h2 style="color: var(--primary-color);">ðŸ“Š Advanced Analytics</h2>
            <p style="color: #9ca3af;">VisÃ£o profunda do seu progresso e alinhamento com o mercado.</p>
        </div>
        <div>
             <span style="background: gold; color: black; padding: 5px 15px; border-radius: 20px; font-weight: bold;">PREMIUM EXCLUSIVE</span>
        </div>
    </div>

    <div class="grid-charts" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(400px, 1fr)); gap: 30px;">

        <!-- SKILLS GROWTH CHART -->
        <div class="card">
            <h3>ðŸ“ˆ Crescimento de Habilidades</h3>
            <canvas id="growthChart"></canvas>
        </div>

        <!-- MARKET FIT RADAR -->
        <div class="card">
            <h3>ðŸŽ¯ Market Fit (VocÃª vs Mercado)</h3>
            <canvas id="radarChart"></canvas>
        </div>

        <!-- STATS CARDS -->
        <div class="card" style="grid-column: 1 / -1;">
            <h3>âš¡ Insights de Performance</h3>
            <div style="display: flex; gap: 20px; justify-content: space-around; flex-wrap: wrap; margin-top: 20px;">
                <div style="text-align: center;">
                    <h4 style="font-size: 2rem; margin: 0; color: var(--secondary-color);">Top 5%</h4>
                    <p style="color: #6b7280;">Seu ranking em Python</p>
                </div>
                <div style="text-align: center;">
                    <h4 style="font-size: 2rem; margin: 0; color: var(--primary-color);">+15%</h4>
                    <p style="color: #6b7280;">Aumento de demanda na sua Ã¡rea</p>
                </div>
                <div style="text-align: center;">
                    <h4 style="font-size: 2rem; margin: 0; color: #fbbf24;">850</h4>
                    <p style="color: #6b7280;">Tokens economizados</p>
                </div>
            </div>
        </div>
    </div>

    <div style="margin-top: 30px; text-align: right;">
        <a href="/dashboard" class="btn-outline">Voltar ao Dashboard</a>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
    // Data passed from backend
    const data = {{ data | tojson }};

    // Growth Chart
    const ctxGrowth = document.getElementById('growthChart').getContext('2d');
    new Chart(ctxGrowth, {
        type: 'line',
        data: {
            labels: data.dates,
            datasets: [{
                label: 'Seu NÃ­vel TÃ©cnico',
                data: data.skills_growth,
                borderColor: '#00ff88',
                backgroundColor: 'rgba(0, 255, 136, 0.1)',
                tension: 0.4,
                fill: true
            },
            {
                label: 'Demanda de Mercado',
                data: data.market_demand,
                borderColor: '#00f3ff',
                backgroundColor: 'rgba(0, 243, 255, 0.05)',
                borderDash: [5, 5],
                tension: 0.4
            }]
        },
        options: {
            responsive: true,
            plugins: {
                legend: { labels: { color: 'white' } }
            },
            scales: {
                y: { grid: { color: '#374151' }, ticks: { color: '#9ca3af' } },
                x: { grid: { color: '#374151' }, ticks: { color: '#9ca3af' } }
            }
        }
    });

    // Radar Chart
    const ctxRadar = document.getElementById('radarChart').getContext('2d');
    new Chart(ctxRadar, {
        type: 'radar',
        data: {
            labels: data.radar_labels,
            datasets: [{
                label: 'Seu Perfil',
                data: data.radar_data_user,
                borderColor: '#fbbf24',
                backgroundColor: 'rgba(251, 191, 36, 0.2)',
                pointBackgroundColor: '#fbbf24'
            }, {
                label: 'Requisitos Vaga Senior',
                data: data.radar_data_market,
                borderColor: '#a855f7',
                backgroundColor: 'rgba(168, 85, 247, 0.2)',
                pointBackgroundColor: '#a855f7'
            }]
        },
        options: {
            responsive: true,
            scales: {
                r: {
                    angleLines: { color: '#374151' },
                    grid: { color: '#374151' },
                    pointLabels: { color: 'white', font: { size: 12 } },
                    ticks: { backdropColor: 'transparent', color: '#9ca3af' }
                }
            },
            plugins: {
                legend: { labels: { color: 'white' } }
            }
        }
    });
</script>
{% endblock %}
